---
title: "Setup"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Setup}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Setup

You can install the development version from GitHub with:

```{r, eval=FALSE}
# install.packages("devtools")
library(devtools)
devtools::install_github("etam4260/hudr")
```

The US Department of Housing and Urban Development for HUD USER requires users 
to gain an  access key before querying their systems. You must go to https://www.huduser.gov/hudapi/public/register?comingfrom=1 and follow the 
instructions for making an account.

From there you need to make a new token. Make sure to save the token somewhere 
as you will only be able to view it once. However, you can use it as many times 
as you want. You can now supply the 'key' argument to the function calls. 
However, it is **NOT RECOMMENDED** to do this. Rather, to reduce the need to 
supply the key argument in every function call, you can use the Sys.setenv() 
function to save the key to the user environment.

HUD Exchange has data stored in files and does not have a readily available API
system for gaining access to their data. Furthermore, this only supports the 
public data portal.

## Interactive Key Setup

There are various method of setting up a key. However, I recommend using the
Sys.setenv() function. 

### Using Sys.setenv() during an interactive session
One method of setting the API key is to use environment variables. This library
searches for HUD_KEY in the user environment to check if a key has been defined.
If no key has been defined, an empty string is outputted. 

```{r, eval=FALSE}
library(hudr)

Sys.getenv("HUD_KEY")
```

To set the key...

```{r, eval=FALSE}
Sys.setenv("HUD_KEY" = "2yeuduhq72ueajk")
# "2yeuduhq72ueajk" is just a sample key. You need to go to https://www.huduser.gov/hudapi/public/register?comingfrom=1 and register for a key and replace it here.
Sys.getenv("HUD_KEY")
```

You can also use the quicker to type hud_set_key()

```{r, eval=FALSE}
hud_set_key("2yeuduhq72ueajk")
```

To check whether hudr can gain access to this environment variable...

```{r, eval=FALSE}
hud_get_key()
```

It is now set up for the rest of the R session.

## Rprofile

You also choose to save it into your .Rprofile to save the key in between R session.

When R starts it looks for .Rprofile files in different locations:

*R_HOME: which is the directory in that R is installed,
*HOME: the user's home directory,
*The current working directory for R
*R only loads one .Rprofile file per session and thus an .Rprofile file at the project-level overrides files in other locations.

The .Rprofile file is an R script that is launch each time R starts. Sometimes it
might not be in these locations. You can just create one and put it at
the root of your project and type the following in it:

```{r, eval=FALSE}
HUD_KEY = "2yeuduhq72ueajk"
# "2yeuduhq72ueajk" is just a sample key. You need to go to https://www.huduser.gov/hudapi/public/register?comingfrom=1 and register for a key and replace it here.
```
